<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tijdregistratie</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Manifest & icon -->
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='64' height='64'%3E%3Crect width='64' height='64' rx='12' fill='%230ea5e9'/%3E%3Cpath d='M20 16h24v6H20zM16 26h16v6H16zM16 36h28v6H16z' fill='white'/%3E%3C/svg%3E" />

  <style>
    .dragging { opacity: .5 }
    .menu-shadow { box-shadow: 0 10px 30px rgba(0,0,0,.15) }
    .no-tap-highlight { -webkit-tap-highlight-color: transparent; }
    .glass { background: rgba(255,255,255,.75); backdrop-filter: blur(10px); }
    .btn { @apply px-4 py-2 rounded; }
    .btn-primary { @apply bg-sky-600 text-white hover:bg-sky-700; }
    .btn-ghost { @apply border border-slate-300 hover:bg-slate-50; }
    .input { @apply w-full border rounded px-3 h-11 bg-white; }
    .label { @apply text-sm text-slate-600; }
    .link { @apply text-sky-600 hover:text-sky-700 underline; }
  </style>
</head>
<body class="bg-gradient-to-br from-slate-50 via-sky-50 to-white text-slate-900 antialiased select-none">

  <!-- App bar -->
  <header class="sticky top-0 z-30 bg-white/80 backdrop-blur border-b border-slate-200">
    <div class="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-8 h-8 rounded-lg bg-sky-500 grid place-items-center text-white font-bold">T</div>
        <h1 class="text-lg font-semibold">Tijdregistratie</h1>
        <span id="activeWarning" class="ml-3 text-xs font-medium px-2 py-1 rounded hidden"></span>
      </div>

      <div class="flex items-center gap-3">
        <button id="helpBtn" class="text-slate-600 hover:text-slate-900" title="Help">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M12 18h.01M9.09 9a3 3 0 015.83 1c0 2-3 2.5-3 4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </button>
        <button id="menuBtn" class="no-tap-highlight p-2 rounded hover:bg-slate-100" title="Menu">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor"><circle cx="12" cy="5" r="2"/><circle cx="12" cy="12" r="2"/><circle cx="12" cy="19" r="2"/></svg>
        </button>
      </div>
    </div>
  </header>

  <!-- Context menu -->
  <aside id="menu" class="hidden fixed right-4 top-14 bg-white menu-shadow rounded-lg border border-slate-200 w-56 z-40">
    <nav class="py-2">
      <button id="nav-register" class="flex w-full items-center gap-3 px-3 py-2 hover:bg-slate-100">
        <span class="w-2 h-2 rounded-full bg-emerald-500"></span> Registreren
      </button>
      <button id="nav-dashboard" class="flex w-full items-center gap-3 px-3 py-2 hover:bg-slate-100">
        <span class="w-2 h-2 rounded-full bg-sky-500"></span> Dashboard
      </button>
      <button id="nav-manage" class="flex w-full items-center gap-3 px-3 py-2 hover:bg-slate-100">
        <span class="w-2 h-2 rounded-full bg-violet-500"></span> Taakbeheer
      </button>
      <button id="nav-settings" class="flex w-full items-center gap-3 px-3 py-2 hover:bg-slate-100">
        <span class="w-2 h-2 rounded-full bg-amber-500"></span> Instellingen
      </button>
      <button id="nav-export" class="flex w-full items-center gap-3 px-3 py-2 hover:bg-slate-100">
        <span class="w-2 h-2 rounded-full bg-pink-500"></span> Export
      </button>
      <div class="h-px bg-slate-200 my-2"></div>
      <button id="nav-login" class="flex w-full items-center gap-3 px-3 py-2 hover:bg-slate-100">
        <span class="w-2 h-2 rounded-full bg-slate-400"></span> Login / Registreren
      </button>
      <button id="nav-logout" class="flex w-full items-center gap-3 px-3 py-2 hover:bg-slate-100 hidden">
        <span class="w-2 h-2 rounded-full bg-slate-400"></span> Uitloggen
      </button>
    </nav>
  </aside>

  <!-- Schermen -->
  <main class="max-w-5xl mx-auto p-4">
    <!-- Hoofdscherm -->
    <section id="screen-main" class="hidden">
      <div class="mb-4 flex items-center justify-between">
        <h2 class="text-base font-semibold">Taken</h2>
        <div class="text-sm text-slate-500" id="userInfo">Niet ingelogd</div>
      </div>
      <ul id="taskList" class="space-y-2" aria-live="polite"></ul>
      <div id="emptyState" class="hidden text-center py-16 text-slate-500">Nog geen taken. Voeg er √©√©n toe met de ‚Äú+‚Äù.</div>
      <button id="fabAdd" class="fixed right-4 bottom-20 md:bottom-8 w-14 h-14 rounded-full bg-emerald-600 hover:bg-emerald-700 text-white text-3xl shadow-lg">+</button>
    </section>

    <!-- Dashboard -->
    <section id="panel-dashboard" class="hidden">
      <div class="flex items-center justify-between mb-3">
        <h2 class="text-base font-semibold">Dashboard</h2>
        <button id="dashClose" class="text-slate-500 hover:text-slate-900">‚úï</button>
      </div>
      <div class="space-y-4" id="dashboardRoot"></div>
    </section>

    <!-- Taakbeheer -->
    <section id="panel-manage" class="hidden">
      <div class="flex items-center justify-between mb-3">
        <h2 class="text-base font-semibold">Taakbeheer</h2>
        <button id="manageClose" class="text-slate-500 hover:text-slate-900">‚úï</button>
      </div>
      <ul id="manageList" class="space-y-2"></ul>
      <button id="fabAddManage" class="fixed right-4 bottom-20 md:bottom-8 w-14 h-14 rounded-full bg-emerald-600 hover:bg-emerald-700 text-white text-3xl shadow-lg">+</button>
    </section>

    <!-- Instellingen -->
    <section id="panel-settings" class="hidden">
      <div class="flex items-center justify-between mb-3">
        <h2 class="text-base font-semibold">Instellingen</h2>
        <button id="settingsClose" class="text-slate-500 hover:text-slate-900">‚úï</button>
      </div>
      <div class="grid gap-4 md:grid-cols-3">
        <label class="block">
          <span class="label">Kleur >3 actieve taken</span>
          <input id="warn3" type="color" class="w-full h-10 border rounded" />
        </label>
        <label class="block">
          <span class="label">Kleur >5 actieve taken</span>
          <input id="warn5" type="color" class="w-full h-10 border rounded" />
        </label>
        <label class="block">
          <span class="label">Kleur >7 actieve taken</span>
          <input id="warn7" type="color" class="w-full h-10 border rounded" />
        </label>
      </div>
      <div class="mt-4">
        <button id="saveSettings" class="btn btn-primary">Opslaan</button>
      </div>
    </section>

    <!-- Export -->
    <section id="panel-export" class="hidden">
      <div class="flex items-center justify-between mb-3">
        <h2 class="text-base font-semibold">Export</h2>
        <button id="exportClose" class="text-slate-500 hover:text-slate-900">‚úï</button>
      </div>
      <div class="space-y-3">
        <div class="grid gap-3 md:grid-cols-3">
          <label class="block">
            <span class="label">Van (ISO)</span>
            <input id="expFrom" type="datetime-local" class="input" />
          </label>
          <label class="block">
            <span class="label">Tot (ISO)</span>
            <input id="expTo" type="datetime-local" class="input" />
          </label>
        </div>
        <button id="btnExport" class="btn btn-primary">Exporteer CSV</button>
        <a id="downloadLink" class="hidden link">Download CSV</a>
      </div>
    </section>

    <!-- AUTH ‚Äì premium card -->
    <section id="panel-auth" class="pt-10 pb-16">
      <div class="mx-auto max-w-3xl">
        <div class="grid md:grid-cols-2 gap-8 items-center">
          <!-- Hero copy -->
          <div>
            <h2 class="text-2xl font-bold leading-tight">Welkom terug üëã</h2>
            <p class="mt-2 text-slate-600">Registreer je tijd per taak. Multitask, aandacht‚Äëverdeling en export ‚Äì alles in √©√©n snelle PWA.</p>
            <ul class="mt-4 space-y-2 text-slate-600">
              <li class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-emerald-500"></span> Meerdere taken tegelijk</li>
              <li class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-sky-500"></span> Aandacht binnen min/max</li>
              <li class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-violet-500"></span> CSV‚Äëexport en dashboard</li>
            </ul>
          </div>

          <!-- Card -->
          <div class="glass rounded-xl border border-slate-200 p-4">
            <div class="flex rounded-lg bg-slate-100 p-1 text-sm">
              <button id="tabLogin" class="flex-1 py-2 rounded-md bg-white shadow text-slate-900 font-medium">Inloggen</button>
              <button id="tabRegister" class="flex-1 py-2 rounded-md text-slate-600 hover:text-slate-900">Registreren</button>
            </div>

            <!-- Login -->
            <form id="formLogin" class="space-y-3 mt-4">
              <label class="block">
                <span class="label">E‚Äëmail</span>
                <input id="loginEmail" type="email" class="input" placeholder="jij@voorbeeld.nl" required />
              </label>
              <label class="block">
                <span class="label">Wachtwoord</span>
                <div class="relative">
                  <input id="loginPass" type="password" class="input pr-11" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required />
                  <button type="button" id="loginToggle" class="absolute right-2 top-1/2 -translate-y-1/2 text-slate-500 hover:text-slate-800" title="Toon/verberg">
                    üëÅÔ∏è
                  </button>
                </div>
              </label>
              <div class="flex items-center justify-between">
                <label class="flex items-center gap-2 text-sm text-slate-600">
                  <input id="rememberMe" type="checkbox" class="w-4 h-4" /> Aangemeld blijven
                </label>
                <button id="btnResetReq" type="button" class="text-sm link">Wachtwoord vergeten?</button>
              </div>
              <button id="btnLogin" class="btn btn-primary w-full flex items-center justify-center gap-2">
                <span class="inline-block" id="loginLabel">Inloggen</span>
                <span id="loginSpinner" class="hidden animate-spin">‚è≥</span>
              </button>
              <p class="text-center text-sm text-slate-600">Nog geen account? <a href="#" id="gotoRegister" class="link">Registreren</a></p>
              <div id="authError" class="hidden text-sm text-rose-600 bg-rose-50 border border-rose-200 rounded p-2"></div>
            </form>

            <!-- Register -->
            <form id="formRegister" class="space-y-3 mt-4 hidden">
              <label class="block">
                <span class="label">E‚Äëmail</span>
                <input id="regEmail" type="email" class="input" placeholder="jij@voorbeeld.nl" required />
              </label>
              <label class="block">
                <span class="label">Wachtwoord (minimaal 10 tekens)</span>
                <div class="relative">
                  <input id="regPass" type="password" class="input pr-11" minlength="10" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required />
                  <button type="button" id="regToggle" class="absolute right-2 top-1/2 -translate-y-1/2 text-slate-500 hover:text-slate-800" title="Toon/verberg">
                    üëÅÔ∏è
                  </button>
                </div>
                <div id="pwMeter" class="mt-1 h-1 rounded bg-slate-200 overflow-hidden">
                  <div id="pwBar" class="h-1 w-0 bg-rose-500"></div>
                </div>
                <p id="pwHint" class="text-xs text-slate-500 mt-1">Gebruik een zin of combineer hoofdletters, cijfers en symbolen.</p>
              </label>
              <button id="btnRegister" class="btn btn-primary w-full flex items-center justify-center gap-2">
                <span id="regLabel">Account maken</span>
                <span id="regSpinner" class="hidden animate-spin">‚è≥</span>
              </button>
              <p class="text-center text-sm text-slate-600">Heb je al een account? <a href="#" id="gotoLogin" class="link">Inloggen</a></p>
              <div id="regError" class="hidden text-sm text-rose-600 bg-rose-50 border border-rose-200 rounded p-2"></div>
            </form>

            <!-- Reset -->
            <div id="resetBox" class="hidden mt-4 space-y-3">
              <label class="block">
                <span class="label">Reset‚Äëtoken (of kom via je e‚Äëmaillink)</span>
                <input id="resetToken" type="text" class="input" />
              </label>
              <label class="block">
                <span class="label">Nieuw wachtwoord</span>
                <input id="resetPass" type="password" class="input" />
              </label>
              <button id="btnResetDo" class="btn btn-primary w-full">Resetten</button>
              <div id="resetMsg" class="hidden text-sm text-emerald-700 bg-emerald-50 border border-emerald-200 rounded p-2"></div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Modal taak -->
  <div id="modalTask" class="fixed inset-0 bg-black/40 hidden z-50">
    <div class="bg-white rounded-lg max-w-md mx-auto mt-20 p-4">
      <div class="flex items-center justify-between">
        <h3 id="modalTitle" class="text-base font-semibold">Taak</h3>
        <button id="modalClose" class="text-slate-500 hover:text-slate-900">‚úï</button>
      </div>
      <div class="mt-3 space-y-3">
        <input id="taskName" type="text" placeholder="Naam" class="input" />
        <div class="grid md:grid-cols-2 gap-3">
          <label class="block">
            <span class="label">Kleur</span>
            <input id="taskColor" type="color" class="w-full h-10 border rounded" />
          </label>
          <div class="flex items-end">
            <button id="btnSoftColor" class="btn btn-ghost w-full">Zachte kleur</button>
          </div>
        </div>
        <div class="grid md:grid-cols-2 gap-3">
          <label class="block">
            <span class="label">Min aandacht (%)</span>
            <input id="taskMin" type="number" min="0" max="100" value="0" class="input" />
          </label>
          <label class="block">
            <span class="label">Max aandacht (%)</span>
            <input id="taskMax" type="number" min="1" max="100" value="100" class="input" />
          </label>
        </div>
      </div>
      <div class="mt-4 flex justify-end gap-2">
        <button id="btnDeleteTask" class="hidden btn btn-ghost">Verwijderen</button>
        <button id="btnSaveTask" class="btn btn-primary">Opslaan</button>
      </div>
    </div>
  </div>

  <!-- Help overlay -->
  <div id="helpOverlay" class="fixed inset-0 bg-black/60 hidden z-50">
    <div class="max-w-lg mx-auto mt-16 bg-white rounded-lg p-5 space-y-3">
      <div class="text-lg font-semibold">Snel aan de slag</div>
      <ol class="list-decimal list-inside text-slate-700 space-y-2">
        <li>Log in of registreer je account.</li>
        <li>Maak taken met ‚Äú+‚Äù. Start/stop ‚Äì meerdere tegelijk kan.</li>
        <li>Sleep taken om de volgorde te bewaren.</li>
        <li>Aandacht verdeelt 100% eerlijk binnen min/max.</li>
        <li>Dashboard voor totalen, Export voor CSV.</li>
      </ol>
      <div class="text-right">
        <button id="helpClose" class="btn btn-primary">Aan de slag</button>
      </div>
    </div>
  </div>

  <script src="dashboard.js"></script>
  <script src="script.js"></script>

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js').catch(console.error);
      });
    }
  </script>
</body>
</html>
